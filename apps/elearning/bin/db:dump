#!/usr/bin/env sh

SCHEMAS=auth,public,storage
MIGRATIONS_PATH=./supabase/migrations

file=$1

if [ -z "$file" ]; then
  echo "You must provide a migration name."
  echo "Usage: $0 <migration_name>"
  exit 1
fi

./node_modules/.bin/supabase db diff --schema $SCHEMAS --file "$file"
./node_modules/.bin/prettier --write $MIGRATIONS_PATH/*.sql
./node_modules/.bin/snaplet-seed sync
sh ./.bin/typegen 
